<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Resampling-Based Multiple Testing Adjustments for Linear Regression • multitestr</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Resampling-Based Multiple Testing Adjustments for Linear Regression">
<meta property="og:description" content="An implementation of Westfall and Young's (1993) free step-down
    method to adjust p-values for multiple testing.">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">multitestr</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.1.1.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="articles/multitestr.html">Get started</a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    

    
    
<!-- README.md is generated from README.Rmd. Please edit that file -->
<div id="multitestr" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#multitestr" class="anchor"></a>multitestr</h1></div>
<p><code>multitestr</code> implements bootstrap-based multiple testing adjustments for hypothesis tests conducted on linear regression coefficients. These adjustments are often used in social science experiments where many outcomes or subgroups are analyzed and there is a risk of falsely rejecting the null of a particular hypothesis purely by chance. While <code>R</code>’s built-in function <code>p.adjust</code> performs variety of multiple testing adjustments such as the Bonferroni or Holm corrections, these approaches can be quite conservative when test statistics are correlated. The booststrap-based adjustments used in this package allow for correlations across test-statistics and hence can be more powerful.</p>
<p>Currently, we implement the Westfall and Young (1993) bootstrap based procedure to control the <em>familywise error rate</em> (FWER) for a family of hypotheses. Users may specify either the “pairs” non-parametric bootstrap or the Wild parameteric bootstrap.</p>
<p>For additional technical and implementation details, please read the <a href="https://fdhidalgo.github.io/multitestr/articles/multitestr.html">Vignette</a>.</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>You can install the current version of <code>multitestr</code> from <a href="https://github.com/fdhidalgo/multitestr">Github</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">install.packages</span>(<span class="st">"devtools"</span>)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2">devtools<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/devtools/topics/reexports">install_github</a></span>(<span class="st">"fdhidalgo/multitestr"</span>)</a></code></pre></div>
</div>
<div id="example" class="section level2">
<h2 class="hasAnchor">
<a href="#example" class="anchor"></a>Example</h2>
<p>To demonstrate <code>multitestr</code>‘s functionality, we reproduce (up to sampling error) some results from Casey et al (2012). The study estimates the effect of a ``community-driven development’’ program on 12 composite outcomes in Sierra Leone.</p>
<p>The user must specify a list of <code>full_formulas</code> and <code>null_formulas</code>, where the <code>full_formulas</code> are the full regression models being tested and <code>null_formulas</code> are models under the null hypothesis. In this particular case, the <code>full_formulas</code> are formulas with 12 different outcome variables (<code>z_score_1</code>…<code>z_score_12</code>), the treatment variable (<code>t</code>), pre-treatment covariates (<code>tothhs</code> and <code>road</code>), and strata fixed effects (<code>ward</code>). The <code>null_formulas</code> are the corresponding models without a treatment variable, since the null hyptothesis is that the treatment had no effect.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">library</span>(<span class="st">"multitestr"</span>)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="co"># Replicate Casey et al 2012, Table II Column 3</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="co"># Create a list of formulas with different dependent variables</span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5">F &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="kw">sprintf</span>(<span class="st">"zscore_%d ~ 0 + t + tothhs + road + ward"</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">12</span>),</a>
<a class="sourceLine" id="cb2-6" data-line-number="6">            as.formula)</a>
<a class="sourceLine" id="cb2-7" data-line-number="7"></a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="co">#Run the Westfall and Young boostrap step down procedure            </span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9">pvals &lt;-<span class="st"> </span><span class="kw"><a href="reference/boot_stepdown.html">boot_stepdown</a></span>(<span class="dt">full_formulas =</span> F,</a>
<a class="sourceLine" id="cb2-10" data-line-number="10">                       <span class="dt">null_formulas =</span> <span class="kw">lapply</span>(F, update, . <span class="op">~</span><span class="st"> </span>. <span class="op">-</span><span class="st"> </span>t),</a>
<a class="sourceLine" id="cb2-11" data-line-number="11">                       <span class="dt">data =</span> gobifo,</a>
<a class="sourceLine" id="cb2-12" data-line-number="12">                       <span class="dt">coef_list =</span> <span class="st">"t"</span>, <span class="co">#this parameter specifies the coefficient of interest</span></a>
<a class="sourceLine" id="cb2-13" data-line-number="13">                       <span class="dt">nboots =</span> <span class="dv">1000</span>, </a>
<a class="sourceLine" id="cb2-14" data-line-number="14">                       <span class="dt">parallel =</span> <span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb2-15" data-line-number="15">                       <span class="dt">boot_type =</span> <span class="st">"pairs"</span>)</a>
<a class="sourceLine" id="cb2-16" data-line-number="16"><span class="co">#&gt; ===========================================================================</span></a>
<a class="sourceLine" id="cb2-17" data-line-number="17"><span class="co">#b</span></a>
<a class="sourceLine" id="cb2-18" data-line-number="18">dplyr<span class="op">::</span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/summarise_all.html">mutate_if</a></span>(pvals, is.numeric, round, <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb2-19" data-line-number="19"><span class="co">#&gt;       Hypothesis Variable bs_pvalues_unadjusted bs_pvalues_adjusted</span></a>
<a class="sourceLine" id="cb2-20" data-line-number="20"><span class="co">#&gt; 1   Hypothesis 1        t                 0.001               0.001</span></a>
<a class="sourceLine" id="cb2-21" data-line-number="21"><span class="co">#&gt; 2   Hypothesis 2        t                 0.001               0.001</span></a>
<a class="sourceLine" id="cb2-22" data-line-number="22"><span class="co">#&gt; 3   Hypothesis 3        t                 0.001               0.001</span></a>
<a class="sourceLine" id="cb2-23" data-line-number="23"><span class="co">#&gt; 4   Hypothesis 4        t                 0.738               0.981</span></a>
<a class="sourceLine" id="cb2-24" data-line-number="24"><span class="co">#&gt; 5   Hypothesis 5        t                 0.938               0.981</span></a>
<a class="sourceLine" id="cb2-25" data-line-number="25"><span class="co">#&gt; 6   Hypothesis 6        t                 0.134               0.677</span></a>
<a class="sourceLine" id="cb2-26" data-line-number="26"><span class="co">#&gt; 7   Hypothesis 7        t                 0.359               0.915</span></a>
<a class="sourceLine" id="cb2-27" data-line-number="27"><span class="co">#&gt; 8   Hypothesis 8        t                 0.452               0.915</span></a>
<a class="sourceLine" id="cb2-28" data-line-number="28"><span class="co">#&gt; 9   Hypothesis 9        t                 0.312               0.910</span></a>
<a class="sourceLine" id="cb2-29" data-line-number="29"><span class="co">#&gt; 10 Hypothesis 10        t                 0.043               0.348</span></a>
<a class="sourceLine" id="cb2-30" data-line-number="30"><span class="co">#&gt; 11 Hypothesis 11        t                 0.839               0.981</span></a>
<a class="sourceLine" id="cb2-31" data-line-number="31"><span class="co">#&gt; 12 Hypothesis 12        t                 0.357               0.915</span></a></code></pre></div>
<p><code>bs_pvalues_unadjusted</code> are the bootstrap-based p-values with no adjustment for mutltiple testing. <code>bs_pvalues_adjusted</code> have been adjusted for multiple testing using the algorithm described in Westfall and Young (1993).</p>
</div>
<div id="references" class="section level2">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<p>Casey, Katherine, Rachel Glennerster, and Edward Miguel. 2012. Reshaping Institutions: Evidence on Aid Impacts Using a Preanalysis Plan. <em>Quarterly Journal of Economics.</em> 127(4):1755-1812.</p>
<p>Westfall, Peter H., and S. Stanley Young. 1993. <em>Resampling-Based Multiple Testing: Examples and Methods for P-Value Adjustment.</em> New York: John Wiley &amp; Sons.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Report a bug at <br><a href="NA">NA</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>F. Daniel Hidalgo <br><small class="roles"> Author, maintainer </small>  </li>
</ul>
</div>

      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by F. Daniel Hidalgo.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
